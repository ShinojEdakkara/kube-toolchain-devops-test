<?xml version="1.0" encoding="UTF-8"?>
<!--

    Licensed Materials - Property of IBM
    5725-I43 (C) Copyright IBM Corp. 2011, 2016. All Rights Reserved.
    US Government Users Restricted Rights - Use, duplication or
    disclosure restricted by GSA ADP Schedule Contract with IBM Corp.

-->

<project basedir="." default="help">
  <!-- Start of Property Passwords
        Enter the password value or "************" to be prompted interactively
  -->
  <property name="database.db2.admin.password" value="****UPDATE**** - DB2 administrator password, used to create the DB2 databases (example: db2IsFun)"/>
  <property name="database.db2.mfp.password" value="****UPDATE**** - Password for DB2 (example: mfppassword)"/>
  <!-- End of Property Passwords -->

  <!-- Start of Property Parameters -->
  <property name="mfp.server.install.dir" value="@MFP_INSTALL_DIR@"/>
  <property name="database.db2.host" value="****UPDATE**** - DB2 host name (example: proddb.example.com)"/>
  <property name="database.db2.port" value="****UPDATE**** - DB2 port, by default 50000 (example: 50000)"/>
  <property name="database.db2.instance" value="****UPDATE**** - DB2 database instance (example: DB2)"/>
  <property name="database.db2.driver.dir" value="${mfp.server.install.dir}/mfpf-libs"/>
  <property name="database.db2.admin.username" value="****UPDATE**** - A DB2 administrator, used to create the DB2 databases (example: db2inst1)"/>
  <property name="database.db2.mfp.dbname" value="****UPDATE**** - Database name for MobileFirst Administration Services (example: MFPDATA)"/>
  <property name="database.db2.mfp.schema" value="****UPDATE**** - Database schema for MobileFirst Administration Services (example: MFPDATA)"/>
  <property name="database.db2.mfp.username" value="****UPDATE**** - DB2 user name (example: mfpuser)"/>

  <!--
     Tasks Execution.
  -->
  <property name="mfp.process.admin" value="true"/>
  <property name="mfp.process.runtime" value="true"/>
  <property name="mfp.process.push" value="true"/>
  <!-- End of Property Parameters -->

  <!-- Meta properties for internal use -->
  <property name="mfp.config.parameters.version" value="1.0"/>

  <taskdef resource="com/ibm/mfp/ant/defaults.properties">
    <classpath>
      <fileset dir="${mfp.server.install.dir}/mfpf-libs">
        <include name="mfp-ant-deployer.jar"/>
      </fileset>
    </classpath>
  </taskdef>

  <!-- Start of the databases target Generated by MobileFirst Server -->
  <target name="databases" depends="admdatabases, rtmdatabases, pushdatabases">
  </target>

  <target name="admdatabases">
    <configuredatabase kind="MobileFirstAdmin" execute="${mfp.process.admin}">
      <db2 database="${database.db2.mfp.dbname}"
           server="${database.db2.host}"
           instance="${database.db2.instance}"
           user="${database.db2.mfp.username}"
           port= "${database.db2.port}"
           schema = "${database.db2.mfp.schema}"
           password="${database.db2.mfp.password}">
        <dba user="${database.db2.admin.username}"
             password="${database.db2.admin.password}"/>
      </db2>
      <driverclasspath>
        <fileset dir="${database.db2.driver.dir}">
          <include name="db2jcc4.jar"/>
          <include name="db2jcc_license_*.jar"/>
        </fileset>
      </driverclasspath>
    </configuredatabase>
  </target>

  <target name="rtmdatabases">
    <configuredatabase kind="MobileFirstRuntime" execute="${mfp.process.runtime}">
      <db2 database="${database.db2.mfp.dbname}"
           server="${database.db2.host}"
           instance="${database.db2.instance}"
           user="${database.db2.mfp.username}"
           port= "${database.db2.port}"
           schema = "${database.db2.mfp.schema}"
           password="${database.db2.mfp.password}">
        <dba user="${database.db2.admin.username}"
             password="${database.db2.admin.password}"/>
      </db2>
      <driverclasspath>
        <fileset dir="${database.db2.driver.dir}">
          <include name="db2jcc4.jar"/>
          <include name="db2jcc_license_*.jar"/>
        </fileset>
      </driverclasspath>
    </configuredatabase>
  </target>

  <target name="pushdatabases">
    <configuredatabase kind="Push" execute="${mfp.process.push}">
      <db2 database="${database.db2.mfp.dbname}"
           server="${database.db2.host}"
           instance="${database.db2.instance}"
           user="${database.db2.mfp.username}"
           port= "${database.db2.port}"
           schema = "${database.db2.mfp.schema}"
           password="${database.db2.mfp.password}">
        <dba user="${database.db2.admin.username}"
             password="${database.db2.admin.password}"/>
      </db2>
      <driverclasspath>
        <fileset dir="${database.db2.driver.dir}">
          <include name="db2jcc4.jar"/>
          <include name="db2jcc_license_*.jar"/>
        </fileset>
      </driverclasspath>
    </configuredatabase>
  </target>
  <!-- End of the databases target Generated by MobileFirst Server -->

  <target name="help">
    <basename property="ant.file.basename" file="${ant.file}"/>
    <echo message="This ant project file can be used in the following ways:"/>
    <echo/>
    <echo message="Basic usage :"/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} databases"/>
    <echo message="This task configures or upgrades all the databases of the MobileFirst components (MobileFirst Administration Services, MobileFirst Configuration Services, MobileFirst Runtime, and MobileFirst Push)."/>
    <echo/>
    <echo/>
    <echo message="Advanced usage usage per MobileFirst component :"/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} admdatabases"/>
    <echo message="This task configures or upgrades the databases of the MobileFirst Administration Services and the MobileFirst Configuration Services components."/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} rtmdatabases"/>
    <echo message="This task configures or upgrades the database of the MobileFirst Runtime component."/>
    <echo/>
    <echo message="ant -f ${ant.file.basename} pushdatabases"/>
    <echo message="This task configures or upgrades the database of the MobileFirst Push component."/>
    <echo/></target>
</project>
